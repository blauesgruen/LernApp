<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LernApp - Verwaltung</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/log.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/local-cloud-storage.js"></script>
    <script src="js/app-extensions.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="home.html">
                <i class="bi bi-mortarboard-fill me-2"></i>
                LernApp v1.0
            </a>
        </div>
    </nav>
    <div class="container mt-4">
        <div class="row">
            <div class="col-md-10 mx-auto">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Verwaltung</h2>
                    <a class="btn btn-secondary" href="home.html">
                        <i class="bi bi-house-fill me-2"></i>Zurück
                    </a>
                </div>
                <div id="admin-login-area"></div>
                <div id="admin-content-area" style="display:none">
                    <!-- User-Management für Admin -->
                    <div class="card mb-4">
                        <div class="card-header bg-warning">
                            <h5 class="mb-0"><i class="bi bi-people me-2"></i>Benutzerkonten verwalten</h5>
                        </div>
                        <div class="card-body">
                            <div id="admin-users-list"></div>
                            <div id="admin-user-data" class="mt-4"></div>
                        </div>
                    </div>
                    <div class="row">
                        <!-- Kategorie-Verwaltung -->
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Kategorien verwalten</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="new-category" class="form-label">Neue Kategorie</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="new-category" placeholder="Kategorie-Name">
                                            <button class="btn btn-primary" type="button">
                                                <i class="bi bi-plus-lg"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div id="categories-list">
                                        <!-- Kategorien-Liste wird hier angezeigt -->
                                    </div>
                                    <div id="edit-category-modal" class="modal fade" tabindex="-1">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title">Kategorie bearbeiten</h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                </div>
                                                <div class="modal-body">
                                                    <input type="text" class="form-control" id="edit-category-input">
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Abbrechen</button>
                                                    <button type="button" class="btn btn-primary" id="save-category-edit">Speichern</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ...Rest wie gehabt... -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const adminAccess = sessionStorage.getItem('lernapp_admin_access');
            const loginArea = document.getElementById('admin-login-area');
            const contentArea = document.getElementById('admin-content-area');
            if (!adminAccess) {
                // Direkt das Admin-Login-Modal anzeigen
                if (window.app && typeof window.app.showAdminLogin === 'function') {
                    window.app.showAdminLogin();
                } else if (window.LernApp && typeof window.LernApp.showAdminLogin === 'function') {
                    window.LernApp.showAdminLogin();
                }
                contentArea.style.display = 'none';
                loginArea.innerHTML = '';
            } else {
                loginArea.innerHTML = '<div class="text-end mb-3"><button class="btn btn-danger" id="admin-logout-btn"><i class="bi bi-box-arrow-right me-1"></i>Admin Logout</button></div>';
                contentArea.style.display = 'block';
                setTimeout(function() {
                    var btn = document.getElementById('admin-logout-btn');
                    if (btn) {
                        btn.onclick = function() {
                            sessionStorage.removeItem('lernapp_admin_access');
                            window.location.href = 'home.html';
                        };
                    }
                }, 0);
                // Userliste im Admin-Bereich anzeigen
                if (window.app && typeof window.app.renderAdminUsersList === 'function') {
                    window.app.renderAdminUsersList();
                }
            }
        });
    </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
